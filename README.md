# Bitrix24 Bot - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≠—Ç–∏–∫–µ—Ç–æ–∫ –∏ –ú–∞—Ä–æ–∫

–ë–æ—Ç –¥–ª—è Bitrix24, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∞—Ä—Ö–∏–≤ —Å Excel + –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç PDF —ç—Ç–∏–∫–µ—Ç–∫–∏ –∏ –º–∞—Ä–∫–∏.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env` (–ø—Ä–∏–º–µ—Ä –≤ `.env.example`):

```env
BITRIX_WEBHOOK=https://your-portal.bitrix24.ru/rest/USER_ID/CODE/
HOST=0.0.0.0
PORT=5000
DEBUG=False
LOG_LEVEL=INFO
```

### 3. –ó–∞–ø—É—Å–∫

#### –í–∞—Ä–∏–∞–Ω—Ç –ê: –õ–æ–∫–∞–ª—å–Ω–æ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

```bash
python bitrix_bot.py
```

#### –í–∞—Ä–∏–∞–Ω—Ç –ë: Docker

```bash
docker-compose up -d
```

### 4. –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø (–¥–ª—è Bitrix24)

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–µ–±—Ö—É–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π ngrok:

```bash
ngrok http 5000
```

–£–∫–∞–∂–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π URL –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –±–æ—Ç–∞.

## üì¶ –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–û—Ç–ø—Ä–∞–≤—å –≤ —á–∞—Ç ZIP –∞—Ä—Ö–∏–≤:

```
archive.zip
‚îú‚îÄ‚îÄ data.xlsx           # Excel —Å –¥–∞–Ω–Ω—ã–º–∏
‚îî‚îÄ‚îÄ img/                # –ü–∞–ø–∫–∞ —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    ‚îú‚îÄ‚îÄ logos/          # –õ–æ–≥–æ—Ç–∏–ø—ã –∫–æ–º–ø–∞–Ω–∏–π
    ‚îú‚îÄ‚îÄ certificates/   # –µ–∞—Å.png, —Ä—Å—Ç.png
    ‚îî‚îÄ‚îÄ mark_images/    # mark_images.png
```

### Excel —Ñ–æ—Ä–º–∞—Ç

–ö–æ–ª–æ–Ω–∫–∏ (–Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏–ª–∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º):

- **–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- –ê—Ä—Ç–∏–∫—É–ª
- –ö–æ–¥
- –®—Ç—Ä–∏—Ö–∫–æ–¥
- –õ–æ–≥–æ
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
- –ú–∞—Ç–µ—Ä–∏–∞–ª
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å
- –ò–º–ø–æ—Ä—Ç–µ—Ä
- –°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è
- –î–∞—Ç–∞ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è
- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –¢–∏–ø —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

## üì§ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ë–æ—Ç –≤–µ—Ä–Ω–µ—Ç –∞—Ä—Ö–∏–≤ `result.zip`:

```
result.zip
‚îú‚îÄ‚îÄ labels/             # –≠—Ç–∏–∫–µ—Ç–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ label_TSH-001_1234567.pdf
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ marks/              # –ú–∞—Ä–∫–∏
    ‚îú‚îÄ‚îÄ mark_TSH-001_1234567.pdf
    ‚îî‚îÄ‚îÄ ...
```

## ü§ñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É
- `/help` - –°–ø—Ä–∞–≤–∫–∞

## üõ† –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ bitrix_bot.py              # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îú‚îÄ‚îÄ main.py                    # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —ç—Ç–∏–∫–µ—Ç–æ–∫
‚îú‚îÄ‚îÄ LabelsMarksGenerator/
‚îÇ   ‚îú‚îÄ‚îÄ barcode/              # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —à—Ç—Ä–∏—Ö–∫–æ–¥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ img/                  # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logos/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ certificates/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mark_images/
‚îÇ   ‚îú‚îÄ‚îÄ input/                # –í—Ä–µ–º–µ–Ω–Ω—ã–µ –≤—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ output/               # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ .env
```

### API endpoints

- `POST /webhook` - –ü—Ä–∏–µ–º –≤–µ–±—Ö—É–∫–æ–≤ –æ—Ç Bitrix24
- `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

## üìù Docker –∫–æ–º–∞–Ω–¥—ã

```bash
# –°–±–æ—Ä–∫–∞
docker-compose build

# –ó–∞–ø—É—Å–∫
docker-compose up -d

# –õ–æ–≥–∏
docker-compose logs -f

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|-----------|----------|--------------|
| BITRIX_WEBHOOK | URL –≤–µ–±—Ö—É–∫–∞ Bitrix24 | - |
| HOST | –•–æ—Å—Ç —Å–µ—Ä–≤–µ—Ä–∞ | 0.0.0.0 |
| PORT | –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ | 5000 |
| DEBUG | –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ | False |
| LOG_LEVEL | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | INFO |

## üêõ Troubleshooting

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: `curl http://localhost:5000/health`
- –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: `docker-compose logs -f`

### –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ü—Ä–æ–≤–µ—Ä—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∞—Ä—Ö–∏–≤–∞
- –£–±–µ–¥–∏—Å—å —á—Ç–æ –µ—Å—Ç—å Excel —Ñ–∞–π–ª
- –ü—Ä–æ–≤–µ—Ä—å —Ñ–æ—Ä–º–∞—Ç Excel (.xlsx –∏–ª–∏ .xls)

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.